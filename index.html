<html>
<head>

    <title>Above, Below, and Beyond Tech Talk</title>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="/favicon.png" rel="icon" />

    <link href="/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/tomorrow-night-bright.css" />

    <link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css" />

    <link href="/css/style.css" rel="stylesheet" />
</head>
<body>
<div class="container header">
    <div class="jumbotron">
        <h1>Above, Below, and Beyond Tech Talk</h1>
        <p>by Rahel Lüthy</p>
    </div>
    <nav class="navbar navbar-default">
        <div>
            <ul class="nav navbar-nav">
                <li><a href="/">Blog</a></li>
                <li><a href="/archive.html">Archive</a></li>
                <li><a href="/about.html">About</a></li>
            </ul>
        </div>
    </nav>
</div>
<div class="container content">
    
<div class="info">
    March 30, 2020 <div class="reading-time">⏱ 9 minute read</div>
</div>
<h1>On Self-Care and Science</h1>
<p>If you are a scientist, like me, you probably like facts. We check COVID-19 numbers multiple times per day. We explain log-scale trajectories to our relatives. We read up on the details of serological assays.</p>
<p>And sometimes we lose track of priorities, we forget to take care of ourselves.</p>
<p>Most of us have long lists of self-care routines. Active things, like running and yoga. Mindful practices, like meditation and gratitude journaling. Seemingly basic habits, like hugging our kids or calling a friend. Silly things, like dancing it out around the kitchen isle.</p>
<p>In this post I will give a little background on some lesser known self-care practices that keep me afloat. I will even provide the scientific facts behind them, promised.</p>
<p>Here’s the list:</p>
<ul>
<li><a href="#1">Stairstep Breathing</a></li>
<li><a href="#2">Self-Compassion</a></li>
<li><a href="#3">Cold Showers</a></li>
<li><a href="#4">Completing The Stress Cycle</a></li>
<li><a href="#5">Turning Around Thoughts</a></li>
<li><a href="#6">The Power Of Now</a></li>
<li><a href="#7">Professional Help</a></li>
</ul>
<p>I have been practicing all of these techniques over the last few years, some of them daily. I learned them from professionals – most notably from my therapist and from my yoga teachers.</p>
<p>As usual, <a href="https://github.com/netzwerg/netzwerg.github.com/blob/source/posts/2020-03-30-on-self-care-and-science.markdown">the source of this post is available openly</a>, please correct any mistakes.</p>
<h2 id="stairstep-breathing"><a name="1"></a>Stairstep Breathing</h2>
<p>If you have never done a breathing exercise before, this is the one to get started. Maybe it’s even the only one you will ever need, it is that good. I learned it from my sister-in-law, who is a clinical psychologist.</p>
<p>Start in a relaxed position. There’s no need for a cross-legged yoga posture, just use a chair. Or lay down on your back, the exercise is also very helpful to wind down at night.</p>
<p>For a couple of cycles, observe your breath without influencing it in any way. After your next exhalation:</p>
<ol type="1">
<li>Fill your lungs by inhaling through your nose in a step-wise fashion</li>
<li>Once your lungs are really full – pause…</li>
<li>Breathe out through your nose in one very long and steady stream</li>
<li>Mindfully observe how your body feels</li>
<li>Rinse &amp; repeat!</li>
</ol>
<p>It may be helpful to use the metaphor of climbing a mountain:</p>
<ol type="1">
<li>Climb up in about 5-10 big, steep steps</li>
<li>At the top: pause, look around &amp; enjoy the view</li>
<li>Take the gentle cable-car back down</li>
</ol>
<p>My daughter <a href="https://www.instagram.com/kashmir_saphire">Filipa</a> made a drawing for you: <br /><br /> <img src="/images/stairstep-breathing.png" alt="Stairstep Breathing" style="width: 100%" /> <br /><br /> So what’s the science behind all of this esoteric yoga quack, you might ask? Let me give you just a tiny bit of neurobiology background.</p>
<p>In humans, any response to fear is modulated by a brain structure called the amygdala. Very simply put, this is what the amygdala kicks off in a threatening situation:</p>
<ul>
<li>stress hormone levels increase</li>
<li>breathing becomes shallow and rapid</li>
<li>blood pressure and heart rate go up</li>
<li>complex decision-making disappears</li>
</ul>
<p>The amygdala (actually, it’s the amygdalae – we have two of them) are part of the limbic system. This is a group of brain structures which, evolutionarily, are rather old.</p>
<p>The important thing in the context of our breathing exercise is this: The amygdalae not only trigger a variety of responses, they also <em>monitor</em> bodily functions. As you probably know, we cannot willfully lower our stress hormone levels or influence our blood pressure. However, we <em>can</em> alter our breathing. If we manage to fully fill our lungs and slow our breathing – in stark contrast to the shallow and rapid breathing triggered by the amygdala – we signal the limbic system that everything is under control. It’s like telling the amygdala to “just chill”. It will trust the sensory input based on your lungs, and will in turn wind down all other stress responses, e.g. it will lower blood pressure and cortisol/adrenaline levels.</p>
<p>If you manage to mindfully observe your body’s reactions during and after the breathing exercise, you may even be able to notice how your whole body feels a lot calmer after just a few cycles.</p>
<h2 id="self-compassion"><a name="2"></a>Self-Compassion</h2>
<p>How many times have you told yourself to calm down lately? That you shouldn’t be scared about COVID-19 because you live in a very safe country? That fear won’t get you anywhere? That you shouldn’t complain, because you have food on the table? That your worries are not helpful, and that you should keep quiet? That you should stop whining and just get on that yoga mat?</p>
<p>But: How do you treat a good friend or your children when they trust you with their sorrows?</p>
<p>You probably hear them out patiently. You give them your full attention, without judging their feelings. You acknowledge their suffering and give them a hug. You are just there for them, compassionately.</p>
<p>The thing is, you can do just that with <em>yourself</em>. With self-compassion, we give ourselves the same kindness and care we’d give to a good friend or our children.</p>
<p>Kirstin Neff has many helpful <a href="https://self-compassion.org/category/exercises/#exercises">exercises</a> and a ton of <a href="https://self-compassion.org/the-research/">excellent research</a> around this topic. Most notably, having empathy for ourselves also creates more empathy for others. Empathy, love, and self-compassion are the last things we should ration right now!</p>
<p>Recommended reading: <a href="https://self-compassion.org/self-compassion-kristin-neff/">Self-Compassion: The Proven Power of Being Kind to Yourself</a> by Kristin Neff</p>
<p>Recommended listening: <a href="https://brenebrown.com/podcast/brene-on-comparative-suffering-the-50-50-myth-and-settling-the-ball">Unlocking Us</a> by Brené Brown</p>
<h2 id="cold-showers"><a name="3"></a>Cold Showers</h2>
<p>At the end of your warm shower, turn the water very cold and stay underneath for 30 seconds.</p>
<p>Super simple, yet very good for your nervous system. Here’s why: The vagus nerve is one of the most important nerves in our body. It plays a powerful part in bringing our minds and bodies back to calm after encountering a perceived threat (in today’s time, new COVID-19 numbers can be very threatening).</p>
<p>Exposing your body to cold conditions, such as taking a cold shower, stimulates the vagus nerve. While your body adjusts to the cold, sympathetic activity (“fight-or-flight”) declines, while parasympathetic activity (“rest and digest”) increases.</p>
<p>Recommended reading: <a href="https://www.resilienceandregulation.com/#get_the_book">Nurturing Resilience</a> by Kathy L. Kain and Stephen J. Terrell</p>
<h2 id="completing-the-stress-cycle"><a name="4"></a>Completing The Stress Cycle</h2>
<p>While our ancestors were running from saber-toothed tigers, today’s stressors are very different: work problems, health concerns, money issues – the list goes on and on. We do our best to fix the problems and deal with the stressors, but our bodies stay stuck in the stress response.</p>
<p>The reason is that, evolutionarily, our bodies rely on the full circle of a stress response: Our ancestors ran from the tiger. After successful escape, they hugged their loved ones, shouted in triumph, or fell on the floor crying.</p>
<p>Our stressors have changed, but our body’s needs to deal with the stress are still the same: we need to complete the stress cycle. According to Emily &amp; Amelia Nagoski, these are ways to do it:</p>
<ul>
<li>Physical activity</li>
<li>Creativity</li>
<li>Crying</li>
<li>Laughing</li>
<li>Physical affection</li>
<li>Deep breathing</li>
</ul>
<p>Recommended reading: <a href="http://www.emilynagoski.com/home">Burnout</a> by Emily &amp; Amelia Nagoski</p>
<h2 id="turning-around-thoughts"><a name="5"></a>Turning Around Thoughts</h2>
<p>As scientists, we stick to the facts. Our thinking is razor sharp, and we know what is true. Often, this is very important and helpful, and it is exactly what makes us good scientists. Simultaneously, our black &amp; white thinking is very limiting. It turns us into narrow-minded, stubborn brats who can get lost in simplistic stories. Life is a complex beast, most problems can be tackled from different angles, and many things can be true at the same time.</p>
<p><a href="https://thework.com/instruction-the-work-byron-katie/">The Work</a> by Byron Katie is a very good practice to question your own thinking. It is a form of self inquiry which can be learned easily. While “The Work” involves several steps, the practice of turning around thoughts is the easiest part to get started. Let me give you a quick idea:</p>
<p>Based on your current believes, isolate your thoughts in a simple statement. For example, your thinking may go something like this:</p>
<p>«Rahel is a self-proclaimed scientist who should not spread bullshit like this.»</p>
<p>Now, turn your thoughts around. There are many possible turnarounds:</p>
<p>«Rahel is not a self-proclaimed scientist.»</p>
<p>«Rahel should spread bullshit like this.»</p>
<p>«Rahel should not spread knowledge like this.»</p>
<p>«I should not spread bullshit like this.»</p>
<p>«I myself am a self-proclaimed scientist.»</p>
<p>Ask yourself if any of these opposites is as true or truer than the original thought? Note that the purpose of this inquiry is <em>not</em> to prove you wrong – you have every reason and right to stick to your original thoughts. However, the turnarounds might each hold a tiny bit of truth and provide a new perspective. They may give you a little nudge to be more open-minded and make space for other opinions. Personally, this form of self inquiry often points me to some blind spots which I otherwise tend to avoid because of shame or fear.</p>
<p>Recommended reading: <a href="https://thework.com/books/">Loving What Is</a> by Byron Katie</p>
<h2 id="the-power-of-now"><a name="6"></a>The Power Of Now</h2>
<p>Our thinking, no matter how scientific, is never really in the now. We dwell in the past, or we make up stories for the future. Spinning up narratives is what our brain knows best. The mind feels like it is working in our best interest, but it is actually just inventing problems.</p>
<p>Here’s a great exercise I sometimes practice in bed, when I have trouble falling asleep. I got to know it through Sarah Wilson (who is actually quoting Eckhart Tolle):</p>
<p>«Ask yourself what ‘problem’ you have right now, not next year, tomorrow, or five minutes from now. What is wrong with this moment. Try this with a problem. Feel into the problem now, not in 60 seconds, not in 2 seconds. Now! Is the problem still there? Nope. It’s gone, right? Worries don’t exist in the now. Worries about the future or the past don’t exist either – they’re just narratives we create in the present.»</p>
<p>This exercise is a form of mindfulness meditation. There’s <a href="https://www.nature.com/articles/s41598-018-26268-w">scientific evidence</a> that it results in a gain of <a href="https://en.wikipedia.org/wiki/Insular_cortex">insulae</a> connection strength. The insulae are brain structures believed to be involved in consciousness. They play a role in diverse functions, such as compassion &amp; empathy, self-awareness, cognitive functioning, and interpersonal experience. The more activation in the insulae, the calmer we are.</p>
<p>Recommended reading: <a href="https://www.sarahwilson.com/2017/01/first-make-beast-beautiful/">First, We Make the Beast Beautiful</a> by Sarah Wilson</p>
<h2 id="professional-help"><a name="7"></a>Professional Help</h2>
<p>You made it this far, wow, thanks for reading. Please bear in mind that reading is the easy part. Scientists like you and me are very good at reading and rationalizing. But: These practices are called practices for a reason – they need practice. Just like we need to listen to epidemiologist when it comes to COVID-19, we should rely on professionals when it comes to mental health. Yoga teachers can guide you and provide more details on breathing techniques. Psychotherapists know a lot about the relationships between behavior, thoughts, and emotions. They can help you break cycles that cause suffering in everyday life. Please <a href="https://www.psychologie.ch">reach out for help</a> if you are struggling.</p>
<p>Take care, y’all!</p>

<hr />

<div class="info">
    October 24, 2019 
</div>
<h1>A CSS Subgrid Example</h1>
<p>Whenever I hear about a new technology or language feature, the first question I ask myself is: <strong>Which problem does it solve?</strong> So when I learned about the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout/Subgrid">addition of subgrid to the CSS Grid Layout specification</a>, I wanted to see a simple example which showed a subgrid-based solution to an actual problem. I found <a href="https://www.youtube.com/watch?v=gmQlK3kRft4">helpful videos</a> and <a href="https://rachelandrew.co.uk/archives/2019/04/16/css-subgrid-news-and-demos">rock-solid-but-complicated layout arrangements</a>, but nothing simple.</p>
<p>This post is the 3’-intro I was looking for:</p>
<h2 id="a-simple-form">A Simple Form</h2>
<p>Suppose you are dealing with the following HTML form:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">&lt;form&gt;</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;name&quot;</span><span class="ot"> class=</span><span class="st">&quot;field&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;label-text&quot;</span><span class="kw">&gt;</span>Name<span class="kw">&lt;/span&gt;</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> id=</span><span class="st">&quot;name&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;email&quot;</span><span class="ot"> class=</span><span class="st">&quot;field&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-7" title="7">    <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;label-text&quot;</span><span class="kw">&gt;</span>Email<span class="kw">&lt;/span&gt;</span></a>
<a class="sourceLine" id="cb1-8" title="8">    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;email&quot;</span><span class="ot"> id=</span><span class="st">&quot;email&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb1-9" title="9">  <span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;message&quot;</span><span class="ot"> class=</span><span class="st">&quot;field&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;label-text&quot;</span><span class="kw">&gt;</span>A Looong Label<span class="kw">&lt;/span&gt;</span></a>
<a class="sourceLine" id="cb1-12" title="12">    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> id=</span><span class="st">&quot;message&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb1-13" title="13">  <span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">&lt;/form&gt;</span></a></code></pre></div>
<p>The existing CSS Grid layout already makes it easy to arrange individual fields:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb2-1" title="1"><span class="fu">.field</span> {</a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="kw">display</span>: grid<span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="kw">grid-template-columns</span>: <span class="bu">auto</span> <span class="dv">1</span>fr<span class="op">;</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="kw">grid-column-gap</span>: <span class="dv">1</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="kw">margin-bottom</span>: <span class="dv">1</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-6" title="6">}</a></code></pre></div>
<p>As a result, each row dynamically respects the preferred width of its label:</p>
<p><img src="/images/form-css-grid.png" /></p>
<p>While this is a good start, we would like to have something better:</p>
<p>A two-column definition, so that</p>
<ul>
<li>the widest label determines the width of the left column</li>
<li>all input fields are aligned in the right column</li>
</ul>
<p><img src="/images/form-css-subgrid.png" /></p>
<p>This is exactly what the new <strong>subgrid</strong> feature is for: It matches up its grid lines to lines in the parent grid. We move the two-column grid layout definition to the parent form, and tell the fields to align along these tracks:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb3-1" title="1">form {</a>
<a class="sourceLine" id="cb3-2" title="2">    <span class="kw">display</span>: grid<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="kw">grid-template-columns</span>: <span class="bu">auto</span> <span class="dv">1</span>fr<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">grid-column-gap</span>: <span class="dv">1</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5">}</a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="fu">.field</span> {</a>
<a class="sourceLine" id="cb3-8" title="8">    <span class="kw">display</span>: grid<span class="op">;</span></a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="kw">grid-column</span>: span <span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-10" title="10">    <span class="kw">grid-template-columns</span>: subgrid<span class="op">;</span></a>
<a class="sourceLine" id="cb3-11" title="11">    <span class="kw">margin-bottom</span>: <span class="dv">1</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-12" title="12">}</a></code></pre></div>
<p><em>Caution: CSS Subgrid is <a href="https://caniuse.com/#feat=css-subgrid">only supported in Firefox (v71)</a></em></p>

<hr />

<div class="info">
    November 21, 2018 
</div>
<h1>How we use React/Redux with TypeScript</h1>
<p>Our team develops visual applications in the field of medical informatics. We started using React/Redux with TypeScript a few months ago. This post is a highly opinionated summary of best practices that evolved over time:</p>
<ul>
<li><a href="#1">Favor Types Over Classes</a></li>
<li><a href="#2">Don’t Fear Stringly Types</a></li>
<li><a href="#3">Favor Composition Over Inheritance</a></li>
<li><a href="#4">Immutability FTW</a></li>
<li><a href="#5">Nominal Typing</a></li>
<li><a href="#6">Explicit Types Enhance Readability</a></li>
<li><a href="#7">TSS: CSS + TypeScript = 😍</a></li>
<li><a href="#8">Look Ma, No Semicolons!</a></li>
</ul>
<p>A bit of personal background, to give certain decisions more context: I have been developing user interfaces for over 20 years. Java and OOP have been loyal companions throughout most of this time. A few years ago, I started doing more and more FP, mostly in Scala &amp; Elm, but also in Java (hi <a href="http://www.vavr.io">vavr</a> 👋).</p>
<p>Our team members come from all sorts of backgrounds. When deciding on a web app stack, opinions varied a lot. We finally settled on React/Redux + TypeScript as a compromise – it turned out to be a good decision.</p>
<h2 id="favor-types-over-classes"><a name="1"></a>Favor Types Over Classes</h2>
<p>Coming from an OOP background, it was comforting that TypeScript brings familiar OOP constructs to the table. However, TypeScript is based on a structural type system, which can confuse Java developers very quickly:</p>
<pre class="typescript"><code>class Patient {

    firstName: string
    lastName: string

    constructor(firstName: string, lastName: string) {
        this.firstName = firstName
        this.lastName = lastName
    }
}

const patient: Patient = { firstName: 'Ada', lastName: 'Lovelace' }

console.log(patient instanceof Patient) // false – seriously?! 🤔</code></pre>
<p>I am sure that one could get used to the TypeScript way of working with classes. However, we somehow ended up not using classes at all 🤷. Instead, we exclusively model our data with read-only types:</p>
<pre class="typescript"><code>type Patient = Readonly&lt;{
    id: PatientId
    caseId: CaseId
    bed: BedId
    firstName: string
    lastName: string
}&gt;</code></pre>
<p>Super concise and very safe to use.</p>
<h2 id="dont-fear-stringly-types"><a name="2"></a>Don’t Fear Stringly Types</h2>
<p>Any experienced Java programmer avoids stringly types like the plague. In Java, this makes sense, they prevent the compiler from helping us find errors. The TypeScript compiler works differently, so be ready to embrace patterns which you would avoid in Java:</p>
<pre class="typescript"><code>type Patient = Readonly&lt;{
    gender: 'male' | 'female' | 'non-binary'
}&gt;</code></pre>
<p>Code completion works perfectly fine here:</p>
<p><img src="/images/typescript-code-completion.png" /></p>
<p>And the compiler detects errors flawlessly:</p>
<pre class="typescript"><code>const smartStringHandling = (patient: Patient) =&gt; {
    if (patient.gender === 'whatever') { // compile error
        
    }
}</code></pre>
<p>To give a more advanced example, here’s how we base our action types, actions, and reducers on simple strings:</p>
<p><em>actionTypes.ts</em></p>
<pre class="typescript"><code>const ADD_MESSAGE = 'message/add'
const ADD_TODO = 'todo/add'</code></pre>
<p><em>actions.ts</em></p>
<pre class="typescript"><code>type Action = AddMessageAction | AddTodoAction

type AddMessageAction = Readonly&lt;{
    type: typeof ADD_MESSAGE
    message: Message
}&gt;

type AddTodoAction = Readonly&lt;{
    type: typeof ADD_TODO
    todo: Todo
}&gt;</code></pre>
<p><em>reducer.ts</em></p>
<pre class="typescript"><code>const reducer = (state: State, action: Action): State =&gt; {
    switch (action.type) {
        case ADD_MESSAGE:

            // 🎉 this would require a cast in Java
            const message = action.message

            return {
                ...state,
                messages: state.messages.push(message)
            }
        case ADD_TODO:
            return {
                ...state,
                todos: state.todos.push(action.todo)
            }
    }
}</code></pre>
<h2 id="favor-composition-over-inheritance"><a name="3"></a>Favor Composition Over Inheritance</h2>
<p>As mentioned above, we don’t really use TypeScript’s OOP features, so using inheritance has never been very tempting. Instead, we often use a mix of composition, union types, and intersection types to foster code re-use:</p>
<pre class="typescript"><code>type Patient = Readonly&lt;{
    address: Address // Composition
    gender: 'male' | 'female' | 'non-binary' // Union Type
}&gt;

type Displayable = Readonly&lt;{
    displayName: string
}&gt;

type DisplayablePatient = Patient &amp; Displayable // Intersection Type</code></pre>
<h2 id="immutability-ftw"><a name="4"></a>Immutability FTW</h2>
<p>We haven’t seen many runtime errors, but the ones that occurred were all caused by inconsistent mutations. That’s why we settled on using the <a href="https://facebook.github.io/immutable-js">immutable</a> collections library to make all our state completely read-only:</p>
<pre class="typescript"><code>import { Map } from 'immutable'

type State = Readonly&lt;{
    bedByPatient: Map&lt;PatientId, BedId&gt;
}&gt;</code></pre>
<h2 id="nominal-typing"><a name="5"></a>Nominal Typing</h2>
<p>Using type aliases for your identifiers seems very convenient. No need for extra wrapping, and very readable code:</p>
<pre class="typescript"><code>type PatientId = string
type BedId = string

type State = Readonly&lt;{
    bedByPatient: Map&lt;PatientId, BedId&gt;
}&gt;</code></pre>
<p>Unfortunately, things look more type-safe than they are. Aliases are nothing more than what their name implies: they are simple synonyms. Any <code>string</code> can be used in place of a <code>PatientId</code> or <code>BedId</code> – and vice versa:</p>
<pre class="typescript"><code>
const state: State = {
    bedByPatient: Map&lt;PatientId, BedId&gt;()
}

// Compiles just fine, which is NOT what we want
state.bedByPatient.set('foo', 'bar')</code></pre>
<p>We want to have types which can be distinguished by the compiler because they have different names, even though they share the same structure (a <code>string</code>). This is known as “nominal typing”. The <a href="https://basarat.gitbooks.io/typescript/docs/tips/nominalTyping.html">TypeScript Deep Dive Book</a> gives a good list of nominal typing patterns.</p>
<p>We are using the <code>enum</code>-based brand pattern to get the desired compile-time safety:</p>
<pre class="typescript"><code>enum PatientIdBrand {}
type PatientId = PatientIdBrand &amp; string

enum BedIdBrand {}
type BedId = BedIdBrand &amp; string

type State = Readonly&lt;{
    bedByPatient: Map&lt;PatientId, BedId&gt;
}&gt;

const state: State = {
    bedByPatient: Map()
}

// Compile error:
// Argument type '&quot;foo&quot;' is not assignable to parameter of type 'PatientId'
state.bedByPatient.set('foo', 'bar')</code></pre>
<h2 id="explicit-types-enhance-readability"><a name="6"></a>Explicit Types Enhance Readability</h2>
<p>While it is often possible to not specify types explicitly, they still sometimes enhance code readability (and IDE completion, for that matter). Container components are a good example: they involve a lot of “plumbing”, where input/output types have to match, so explicit types are a plus here. This is how our container components tend to look:</p>
<pre class="typescript"><code>type Props = Readonly&lt;{
    patientId: PatientId
}&gt;

type FromStateProps = Readonly&lt;{
    patient: Patient
}&gt;

const mapStateToProps = (state: State, props: Props): FromStateProps =&gt; {
    const patient = getPatient(state, props.patientId)
    return {
        patient
    }
}

type FromDispatchProps = Readonly&lt;{
    onMouseEnter: () =&gt; void
    onMouseOut: () =&gt; void
}&gt;

const mapDispatchToProps = (dispatch: Dispatch&lt;PatientsAction&gt;, props: Props): FromDispatchProps =&gt; {
    return {
        onMouseEnter: () =&gt; dispatch(selectPatients(ImmutableList.of(props.patientId))),
        onMouseOut: () =&gt; dispatch(selectPatients(ImmutableList()))
    }
}

export default connect(mapStateToProps, mapDispatchToProps)(ExampleComponent)</code></pre>
<h2 id="tss-css-typescript"><a name="7"></a>TSS: CSS + TypeScript = 😍</h2>
<p>As a developer, CSS has always been the scary corner of my applications. It uses a global namespace, you cannot use variables, and it’s almost impossible to tell which code is even in use at all. So you end up treating your CSS very differently from the rest of your code: no refactorings, no re-use, no clean-up.</p>
<p>We are using <a href="https://material-ui.com">Material-UI</a> in all our projects, so it did not take much convincing to also use their styling solution. It uses JSS at its core and has excellent TypeScript support. This is how a basic component looks:</p>
<pre class="typescript"><code>import { createStyles, withStyles, WithStyles } from '@material-ui/core'
import * as React from 'react'

const styles = createStyles({
    root: {
        backgroundColor: 'steelblue'
    }
})

type Props = Readonly&lt;{
    text: string
}&gt; &amp; WithStyles&lt;typeof styles&gt;

const ExampleComponent = ({ text, classes }: Props) =&gt;
    &lt;div className={classes.root}&gt;{text}&lt;/div&gt;

export default withStyles(styles)(ExampleComponent)</code></pre>
<h2 id="look-ma-no-semicolons"><a name="8"></a>Look Ma, No Semicolons!</h2>
<p>And finally, a good practice that is not specific to React nor TypeScript: make your code <a href="https://prettier.io">prettier</a>! We use <a href="https://github.com/typicode/husky">husky</a> to kick off code formatting before each git commit. Here’s our current configuration:</p>
<p><em>.prettierrc:</em></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb15-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="dt">&quot;tabWidth&quot;</span><span class="fu">:</span> <span class="dv">4</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb15-3" title="3">  <span class="dt">&quot;useTabs&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb15-4" title="4">  <span class="dt">&quot;semi&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb15-5" title="5">  <span class="dt">&quot;singleQuote&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb15-6" title="6">  <span class="dt">&quot;printWidth&quot;</span><span class="fu">:</span> <span class="dv">120</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="fu">}</span></a></code></pre></div>
<p><em>Thanks for reviewing this post, <a href="https://twitter.com/ben_rosenbaum">Ben</a>!</em></p>

<hr />

<a class="index-footer" href="/archive.html">Older Posts &raquo; Archive</a>

</div>
<div class="container footer">
    <p>Written by Rahel Lüthy &mdash; Generated by <a href="https://jaspervdj.be/hakyll">Hakyll</a></p>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>