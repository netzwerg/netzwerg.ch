<html>
<head>

    <title>Above, Below, and Beyond Tech Talk</title>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="/favicon.png" rel="icon" />

    <link href="/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/tomorrow-night-bright.css" />

    <link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css" />

    <link href="/css/style.css" rel="stylesheet" />
</head>
<body>
<div class="container header">
    <div class="jumbotron">
        <h1>Above, Below, and Beyond Tech Talk</h1>
        <p>by Rahel Lüthy</p>
    </div>
    <nav class="navbar navbar-default">
        <div>
            <ul class="nav navbar-nav">
                <li><a href="/">Blog</a></li>
                <li><a href="/archive.html">Archive</a></li>
                <li><a href="/about.html">About</a></li>
            </ul>
        </div>
    </nav>
</div>
<div class="container content">
    <div class="info">
    February 27, 2015 
</div>
<h1>Scala Gems #9: Regex Extractors</h1>
<p>Suppose you have a simple date string: <code>&quot;2015-02-27&quot;</code></p>
<p>Regular expressions allow to parse the date and extract parts thereof[^1]: <code>(\d\d\d\d)-(\d\d)-(\d\d)</code> defines a pattern which matches the digits and defines capturing groups for the year, month, and day parts.</p>
<p>In Java, a simple example usage would look like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb1-1" title="1"><span class="bu">Pattern</span> pattern = <span class="bu">Pattern</span>.<span class="fu">compile</span>(<span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d)-(</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d)-(</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d)&quot;</span>);</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="bu">Matcher</span> matcher = pattern.<span class="fu">matcher</span>(<span class="st">&quot;2015-02-27&quot;</span>);</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">while</span> (matcher.<span class="fu">find</span>()) {</a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Year: &quot;</span> + matcher.<span class="fu">group</span>(<span class="dv">1</span>));</a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Month: &quot;</span> + matcher.<span class="fu">group</span>(<span class="dv">2</span>));</a>
<a class="sourceLine" id="cb1-6" title="6">    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Day: &quot;</span> + matcher.<span class="fu">group</span>(<span class="dv">3</span>));</a>
<a class="sourceLine" id="cb1-7" title="7">}</a></code></pre></div>
<p>Accessing the groups by index is rather awkward and error prone. Luckily, Java 7 introduced support for named groups:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb2-1" title="1"><span class="bu">Pattern</span> pattern = <span class="bu">Pattern</span>.<span class="fu">compile</span>(<span class="st">&quot;(?&lt;year&gt;</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d)-(?&lt;month&gt;</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d)-(?&lt;day&gt;</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d)&quot;</span>);</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="bu">Matcher</span> matcher = pattern.<span class="fu">matcher</span>(<span class="st">&quot;2015-02-27&quot;</span>);</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">while</span> (matcher.<span class="fu">find</span>()) {</a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Year: &quot;</span> + matcher.<span class="fu">group</span>(<span class="st">&quot;year&quot;</span>));</a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Month: &quot;</span> + matcher.<span class="fu">group</span>(<span class="st">&quot;month&quot;</span>));</a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Day: &quot;</span> + matcher.<span class="fu">group</span>(<span class="st">&quot;day&quot;</span>));</a>
<a class="sourceLine" id="cb2-7" title="7">}</a></code></pre></div>
<p>That’s better, but I personally don’t like how the group names pollute the pattern. Regular expressions are hard to read already, the Java escape characters add yet more clutter, and the additional <code>?&lt;group&gt;</code> constructs are a kiss of death.</p>
<p>Let’s look at how the same problem can be tackled in Scala:</p>
<p><a href="http://www.scala-lang.org/api/current/#scala.util.matching.Regex">According to the docs</a>, the canonical way to create a <code>Regex</code> is by using the method <code>r</code>, which is provided implicitly for strings:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode scala"><code class="sourceCode scala"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">val</span> Date = <span class="st">&quot;&quot;&quot;(\d\d\d\d)-(\d\d)-(\d\d)&quot;&quot;&quot;</span>.<span class="fu">r</span></a></code></pre></div>
<p>Note the triple quotes, which allow to use the backslashes without further escaping. While this is nice, the true advantage of Scala is that regular expressions can be used as extractors in a pattern match. The pattern stays plain and simple, and yet we have all the freedom to name groups as we please:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode scala"><code class="sourceCode scala"><a class="sourceLine" id="cb4-1" title="1"><span class="st">&quot;2015-02-27&quot;</span> <span class="kw">match</span> {</a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="kw">case</span> Date(year, month, day) =&gt;</a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="fu">println</span>(s<span class="st">&quot;Year: $year&quot;</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="fu">println</span>(s<span class="st">&quot;Month: $month&quot;</span>)</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="fu">println</span>(s<span class="st">&quot;Day: $day&quot;</span>)</a>
<a class="sourceLine" id="cb4-6" title="6">}</a></code></pre></div>
<p>Look ma, no clutter! [^1]:Yes, using <a href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">java.time.format.DateTimeFormatter</a> would be easier in this simple case.</p>

</div>
<div class="container footer">
    <p>Written by Rahel Lüthy &mdash; Generated by <a href="https://jaspervdj.be/hakyll">Hakyll</a></p>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>